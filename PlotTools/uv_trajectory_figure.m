close all
load uv_simulation_data101518b.mat

N = size(ulst, 1);
cmap = myrgb(size(ulst, 1));
v_map = viridis(N);

f = figure;
set(f, 'DefaultFigureRenderer', 'opengl');


for n = 10:size(ulst, 1) - 1
plot3(ulst(n:n+1,1), Ilst(n:n+1,1), ylst(n:n+1,1), 'color', ...
    v_map(n,:),...
    'LineWidth', 1.5);
hold on;
end

grid on;
zticks([0.4, 0.5, 0.6, 0.7, 0.8])
xlabel('$u$', 'interpreter', 'latex')
ylabel('$y$', 'interpreter', 'latex')
zlabel('$I$', 'interpreter', 'latex')

set(gca,'fontsize',16)
set(gca,'FontAngle', 'italic');
set(gca,'FontName', 'Helvetica');
set(gca, 'Color', 'none');
view(gca,[-37.5 30]);
grid(gca,'on');
% Set the remaining axes properties
set(gca,'AmbientLightColor',[0 0 0],'Color','none','Colormap',...
    [0.2422 0.1504 0.6603;0.250390476190476 0.164995238095238 0.707614285714286;0.257771428571429 0.181780952380952 0.751138095238095;0.264728571428571 0.197757142857143 0.795214285714286;0.270647619047619 0.21467619047619 0.836371428571429;0.275114285714286 0.234238095238095 0.870985714285714;0.2783 0.255871428571429 0.899071428571429;0.280333333333333 0.278233333333333 0.9221;0.281338095238095 0.300595238095238 0.941376190476191;0.281014285714286 0.322757142857143 0.957885714285714;0.279466666666667 0.344671428571429 0.971676190476191;0.275971428571429 0.366680952380952 0.982904761904762;0.269914285714286 0.3892 0.9906;0.260242857142857 0.412328571428571 0.995157142857143;0.244033333333333 0.435833333333333 0.998833333333333;0.220642857142857 0.460257142857143 0.997285714285714;0.196333333333333 0.484719047619048 0.989152380952381;0.183404761904762 0.507371428571429 0.979795238095238;0.178642857142857 0.528857142857143 0.968157142857143;0.176438095238095 0.549904761904762 0.952019047619048;0.168742857142857 0.570261904761905 0.935871428571428;0.154 0.5902 0.9218;0.146028571428571 0.609119047619048 0.907857142857143;0.13802380952381 0.627628571428572 0.897290476190476;0.124814285714286 0.645928571428571 0.888342857142857;0.111252380952381 0.6635 0.876314285714286;0.095209523809524 0.679828571428571 0.859780952380952;0.068871428571429 0.694771428571429 0.839357142857143;0.029666666666667 0.708166666666667 0.816333333333333;0.003571428571429 0.720266666666667 0.7917;0.006657142857143 0.731214285714286 0.766014285714286;0.043328571428572 0.741095238095238 0.739409523809524;0.096395238095238 0.75 0.712038095238095;0.140771428571429 0.7584 0.684157142857143;0.1717 0.766961904761905 0.655442857142857;0.193766666666667 0.775766666666667 0.6251;0.216085714285714 0.7843 0.5923;0.246957142857143 0.791795238095238 0.556742857142857;0.290614285714286 0.797290476190476 0.518828571428572;0.340642857142857 0.8008 0.478857142857143;0.3909 0.802871428571428 0.435447619047619;0.445628571428572 0.802419047619048 0.390919047619048;0.5044 0.7993 0.348;0.561561904761905 0.794233333333333 0.304480952380953;0.617395238095238 0.787619047619048 0.261238095238095;0.671985714285714 0.779271428571429 0.2227;0.7242 0.769842857142857 0.191028571428571;0.773833333333333 0.759804761904762 0.164609523809524;0.820314285714286 0.749814285714286 0.153528571428571;0.863433333333333 0.7406 0.159633333333333;0.903542857142857 0.733028571428571 0.177414285714286;0.939257142857143 0.728785714285714 0.209957142857143;0.972757142857143 0.729771428571429 0.239442857142857;0.995647619047619 0.743371428571429 0.237147619047619;0.996985714285714 0.765857142857143 0.219942857142857;0.995204761904762 0.789252380952381 0.202761904761905;0.9892 0.813566666666667 0.188533333333333;0.978628571428571 0.838628571428572 0.176557142857143;0.967647619047619 0.8639 0.164290476190476;0.961009523809524 0.889019047619048 0.153676190476191;0.959671428571429 0.913457142857143 0.142257142857143;0.962795238095238 0.937338095238095 0.126509523809524;0.969114285714286 0.960628571428571 0.106361904761905;0.9769 0.9839 0.0805],...
    'FontAngle','italic','FontSize',16,'GridAlpha',0.2,'GridColor',[0 0 0],...
    'GridLineStyle','--','ZTick',[0.4 0.5 0.6 0.7 0.8]);


%mymakeaxis('x_label', 'u', 'y_label', 'I')
% zlabel('Hey')
% 
% % Plot the z axis
%plot3([0.7 0.7], [0.784 0.784], [0.0 1], 'k')

% dt = double(PARAMS.dt);
% [nsteps, ntrials] = size(ulst);
% 
% tstamps = double(1:nsteps) * double(dt) / 1000;
% 
% figure;
% subplot(4,1,1)
% h1 = plot(tstamps, ulst(:,1:10), 'Color',projectColorMaps('epoch','samples',1,'sampleDepth',1),...
%     'LineWidth',2);
% for i = 1:10
%     h1(i).Color = [0,0,0,0.1];
% end
% 
% ylim([0.7, 1]);
% alpha(0.5)
% mymakeaxis(gca, 'yticks',[0.7, 1], 'y_label', 'u')
% plotFlashes(dt, 3)
% 
% subplot(4,1,2)
% h2 = plot(tstamps, vlst(:,1:10), 'Color',projectColorMaps('epoch','samples',1,'sampleDepth',1),...
%     'LineWidth',2);
% for i = 1:10
%     h2(i).Color = [0,0,0,0.1];
% end
% alpha(0.05)
% ylim([0.2, 0.5])
% mymakeaxis(gca,'y_label', 'v', 'yticks', [0.2, 0.5])
% plotFlashes(dt, 3)
% %plotVertical(80);
% 
% subplot(4,1,3)
% h3 = plot(tstamps, ylst(:,1:10), 'Color',projectColorMaps('epoch','samples',1,'sampleDepth',1),...
%     'LineWidth',2);
% for i = 1:10
%     h3(i).Color = [0,0,0,0.1];
% end
% ylim([0.5, 0.8])
% hold on;
% plotHorizontal(0.7);
% mymakeaxis(gca,'y_label', 'y', 'yticks', [0.5, 0.7])
% plotFlashes(dt, 3)
% %plotVertical(80);
% 
% subplot(4,1,4)
% h4 = plot(tstamps, Ilst(:,1:10), 'Color',projectColorMaps('epoch','samples',1,'sampleDepth',1),...
%     'LineWidth',2);
% ylim([0.77, 0.79])
% for i = 1:10
%     h4(i).Color = [0,0,0,0.1];
% end
% alpha(0.5)
% mymakeaxis(gca,'y_label', 'I', 'x_label', 'Time (ms)')
% plotFlashes(dt, 3)
% 
% function plotFlashes(dt, nFlash)
%     for i = 1:nFlash
%         plotVertical(dt * 80 * i / 1000)
%     end
% end